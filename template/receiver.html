{% load static%}
<html>
	<head>
		<title>call</title>
	</head>
	<body>
		<h1>Audio</h1>

		<button id="startRecordingButton">receiver</button>
		<script src="{% static 'jquery-1.7.1.js' %}" type="text/javascript"></script> 
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script>
		startRecordingButton.addEventListener("click", function () {
				$(document).ready(function(){
					$.ajax({
						url:'http://localhost:8000/api/voice_call_test_1/get/13',
						type:'GET',
						dataType:'json',
						success: function (data, textStatus, xhr) {  
							console.log("data",data['voice_array'])
							var b=b64toBlob(data['voice_array'])
							function b64toBlob(dataURI) {

								var byteString = atob(dataURI.split(',')[1]);
								var ab = new ArrayBuffer(byteString.length);
								var ia = new Uint8Array(ab);

								for (var i = 0; i < byteString.length; i++) {
									ia[i] = byteString.charCodeAt(i);
								}
								return new Blob([ab]);
							}
							console.log("b",b)
							const audioUrl1 = URL.createObjectURL(b);
							console.log("audioUrl",audioUrl1)
							audio = new Audio(audioUrl1);
							audio.play();
							 
						},error: function (xhr, textStatus, errorThrown) { 
							console.log('xhr',xhr)
							console.log('textStatus',textStatus);
							console.log('errorThrown',errorThrown);
						}
					})
				},5000);
			});
			</script>
			</body>
</html>